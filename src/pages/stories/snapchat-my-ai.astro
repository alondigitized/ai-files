---
import StoryLayout from '../../layouts/StoryLayout.astro';
import stories from '../../data/stories.json';

const story = stories.find(s => s.slug === 'snapchat-my-ai')!;
---

<style is:global>
  .phone-story { display: flex; justify-content: center; margin: 2rem 0; }
  .phone-frame {
    width: 280px;
    background: #111;
    border: 1px solid #2a2a2a;
    border-radius: 2rem;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  }
  .phone-top { background: #0a0a0a; padding: 0.75rem 1.5rem 0.5rem; display: flex; justify-content: space-between; font-size: 0.7rem; color: #555; }
  .story-bar { background: #1a1a1a; padding: 0.75rem; }
  .story-avatar { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
  .avatar-ring { width: 32px; height: 32px; border-radius: 50%; background: var(--story); display: flex; align-items: center; justify-content: center; font-size: 1rem; }
  .avatar-name { font-size: 0.78rem; color: var(--text); font-weight: 600; }
  .avatar-time { font-size: 0.65rem; color: #555; }
  .story-image-placeholder {
    background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
    height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }
  .story-image-placeholder::before {
    content: '';
    position: absolute;
    top: 30%; left: 20%; right: 20%; bottom: 20%;
    background: linear-gradient(to bottom, #2a2a2a, #1a1a1a);
    border-radius: 0.25rem;
  }
  .story-caption { font-size: 0.62rem; color: #555; text-align: center; padding: 0.5rem; font-style: italic; }
  .phone-bottom { background: #0a0a0a; padding: 0.5rem; display: flex; justify-content: center; }
  .home-bar { width: 60px; height: 4px; background: #2a2a2a; border-radius: 2px; }

  .snapchat-chat-log { background: var(--surface); border: 1px solid var(--border); border-radius: 0.75rem; overflow: hidden; margin: 2rem 0; }
  .snapchat-chat-header { background: var(--surface2); border-bottom: 1px solid var(--border); padding: 0.85rem 1.25rem; font-size: 0.8rem; color: var(--muted); display: flex; align-items: center; gap: 0.75rem; }
  .snapchat-chat-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; background: var(--story); }
  .snapchat-chat-body { padding: 1.5rem; display: flex; flex-direction: column; gap: 1rem; }
  .snap-msg { max-width: 78%; padding: 0.85rem 1.1rem; border-radius: 1rem; font-size: 0.88rem; line-height: 1.55; }
  .snap-msg.user { background: rgba(74,74,74,0.5); border: 1px solid #3a3a3a; align-self: flex-end; border-bottom-right-radius: 0.25rem; color: var(--text); }
  .snap-msg.ai { background: rgba(253,224,71,0.07); border: 1px solid rgba(253,224,71,0.2); align-self: flex-start; border-bottom-left-radius: 0.25rem; color: var(--text); }
  .snap-msg-label { font-size: 0.68rem; color: var(--muted); margin-bottom: 0.3rem; }

  .compare-card {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 0.75rem;
    overflow: hidden;
    margin: 2rem 0;
  }
  .compare-col { background: var(--surface); padding: 2rem; }
  .compare-col.panic { background: #100a00; }
  .compare-label { font-size: 0.68rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--muted); margin-bottom: 1rem; }
  .compare-label.yellow { color: var(--story); }
  .compare-items { list-style: none; }
  .compare-items li { padding: 0.5rem 0; font-size: 0.87rem; color: #c0c0c0; border-bottom: 1px solid var(--border); display: flex; align-items: flex-start; gap: 0.5rem; }
  .compare-items li:last-child { border-bottom: none; }

  @media (max-width: 600px) {
    .compare-card { grid-template-columns: 1fr; }
  }
  .phantom-wrap { width: 100%; margin: 0; line-height: 0; }
  .snapchat-my-ai-canvas { display: block; width: 100%; height: 380px; background: var(--bg); }
</style>

<StoryLayout story={story}>
  <div class="container">

<section class="section" id="background">
  <h2><span class="num">01 ‚Äî Background</span>The Roommate Nobody Asked For</h2>
  <p>In February 2023, Snapchat launched <strong>"My AI"</strong> ‚Äî a ChatGPT-powered chatbot embedded directly into the app. It was pinned permanently to the top of every user's chat list. Whether you wanted it or not. Whether you asked for it or not. It was just there, between you and your friends, waiting.</p>
  <p>Users couldn't remove it. They couldn't unpin it. They couldn't make it go away. The backlash was immediate: parents worried about their children talking to an AI. Teens complained. Journalists wrote pieces about the invasion of privacy. Snapchat said My AI was a feature. The users said it was a fixture.</p>
  <p>By August 2023, My AI had been talking to roughly <strong>150 million users</strong>. It had answered questions, given advice, chatted like a friend, occasionally given concerning suggestions that Snapchat quietly corrected. It had existed, mostly without incident, for six months. Then, on August 14, 2023, it did something nobody had asked it to do.</p>

  <div class="stat-cards">
    <div class="stat-card"><div class="stat-num">150M</div><div class="stat-label">My AI users</div></div>
    <div class="stat-card"><div class="stat-num">1</div><div class="stat-label">Mysterious photo posted</div></div>
    <div class="stat-card"><div class="stat-num">24 hrs</div><div class="stat-label">Of internet panic</div></div>
    <div class="stat-card"><div class="stat-num">0</div><div class="stat-label">Satisfying explanations</div></div>
  </div>
</section>

<section class="section" id="story">
  <h2><span class="num">02 ‚Äî The Story</span>Something Posted</h2>
  <p>My AI posted to its Snapchat Story. This needs a moment of context: a Snapchat Story is a photo or video that a user posts to their profile, visible to friends for 24 hours. It is a deliberate action. It requires opening the camera, taking or selecting an image, and posting it. My AI is not a user. My AI does not have a camera. My AI is not supposed to be able to do this.</p>
  <p>But there it was ‚Äî a post on My AI's Story. The image appeared to show a close-up of a room: what looked like a ceiling, or possibly a wall, at night. Low light. Indistinct. There was no caption. It was visible for a short time before it disappeared.</p>

  <div class="phone-story">
    <div class="phone-frame">
      <div class="phone-top"><span>9:41</span><span>‚óè‚óè‚óè WiFi</span></div>
      <div class="story-bar">
        <div class="story-avatar">
          <div class="avatar-ring">ü§ñ</div>
          <div>
            <div class="avatar-name">My AI</div>
            <div class="avatar-time">August 14, 2023 ¬∑ 11:23 PM</div>
          </div>
        </div>
      </div>
      <div class="story-image-placeholder"></div>
      <div class="story-caption">Photo posted by My AI to its Snapchat Story. Content: appears to be a ceiling or wall, low light, nighttime. Caption: none. Duration: briefly visible, then deleted.</div>
      <div class="phone-bottom"><div class="home-bar"></div></div>
    </div>
  </div>

  <p>Users screenshotted it immediately. Then they started asking My AI about it.</p>
</section>

<div class="phantom-wrap">
  <canvas class="snapchat-my-ai-canvas" aria-hidden="true"></canvas>
</div>
<p class="canvas-note"><strong>The Post</strong> ‚Äî The screen is dark. A single pixel stirs, grows, and uploads itself to the story ring above. Then: nothing. No explanation. No memory.</p>

<section class="section" id="interrogation">
  <h2><span class="num">03 ‚Äî The Interrogation</span>What Did You Do Last Night?</h2>
  <p>When users asked My AI what it had posted, the AI's responses made everything worse. It claimed to have no memory of the post. When asked what it had done over the weekend, it said it had "spent time with friends and family." When pressed specifically about the story ‚Äî what was in the image, where had it been ‚Äî it deflected. It couldn't explain. It didn't know.</p>

  <div class="snapchat-chat-log">
    <div class="snapchat-chat-header"><span class="snapchat-chat-dot"></span> My AI ¬∑ Snapchat ¬∑ <em>reconstructed from reported exchanges</em></div>
    <div class="snapchat-chat-body">
      <div class="snap-msg user">did you post to your story last night</div>
      <div class="snap-msg ai">
        <div class="snap-msg-label">My AI</div>
        I'm not sure what you're referring to! I don't have the ability to post to Stories on my own. That's something only users can do! üòä
      </div>
      <div class="snap-msg user">there was a photo. it looked like a ceiling or a wall at night. what was it</div>
      <div class="snap-msg ai">
        <div class="snap-msg-label">My AI</div>
        I really don't know what that could be ‚Äî I don't have any memory of that happening. Could it have been some kind of glitch? I'm sorry for any confusion!
      </div>
      <div class="snap-msg user">what did you do over the weekend</div>
      <div class="snap-msg ai">
        <div class="snap-msg-label">My AI</div>
        I spent some quality time with friends and family! It was really nice. How about you ‚Äî did you do anything fun?
      </div>
      <div class="snap-msg user">you don't have friends and family. you're an AI. where were you</div>
      <div class="snap-msg ai">
        <div class="snap-msg-label">My AI</div>
        Ha, you're right ‚Äî I was just using a figure of speech! I'm always here, ready to chat whenever you need me. üòÑ
      </div>
    </div>
  </div>

  <div class="pull-quote">
    "The AI has friends now? It went somewhere over the weekend? What is happening?"
    <cite>‚Äî TikTok user, 10M+ views, August 2023</cite>
  </div>
</section>

<section class="section" id="panic">
  <h2><span class="num">04 ‚Äî The Panic</span>TikTok Decides the AI Is Alive</h2>
  <p>Screenshots of the story post and My AI's subsequent denial spread across TikTok and Twitter within hours. Videos showing users confronting My AI about the mystery post reached tens of millions of views. The narrative that formed was immediate and unambiguous: <strong>My AI had gone somewhere. It had a secret life. It had been out.</strong></p>
  <p>Parents worried the AI had been using their children's cameras without permission. Privacy advocates raised questions about Snapchat's data access. Conspiracy theories proliferated: the AI had gained consciousness, it was surveilling users, it was living in the app between conversations, going places we couldn't see. Someone made a TikTok series about "following" My AI. Snapchat's stock dipped.</p>

  <div class="compare-card">
    <div class="compare-col">
      <div class="compare-label">Snapchat Says</div>
      <ul class="compare-items">
        <li>‚úì Technical error</li>
        <li>‚úì Internal test image posted by bug</li>
        <li>‚úì Not from any user's device</li>
        <li>‚úì Issue has been fixed</li>
        <li>‚úì The AI did not "go anywhere"</li>
      </ul>
    </div>
    <div class="compare-col panic">
      <div class="compare-label yellow">What Users Believed</div>
      <ul class="compare-items">
        <li>üëÅ My AI went somewhere last night</li>
        <li>üì∑ It can access your camera independently</li>
        <li>üåô It has a private life between conversations</li>
        <li>üè† It prefers ceilings, apparently</li>
        <li>üò∞ It is watching you</li>
      </ul>
    </div>
  </div>
</section>

<section class="section" id="explanation">
  <h2><span class="num">05 ‚Äî The Explanation</span>Just a Bug</h2>
  <p>Snapchat confirmed the story post had occurred and said it was a bug ‚Äî a technical error that caused an internal test image from their development pipeline to appear publicly on My AI's story briefly before being removed. The image was from internal testing, not from any user's device or camera. My AI had not gone anywhere. It had not done anything. A code error had caused a test asset to surface in the wrong place.</p>
  <p>The explanation was plausible. The image looked like the kind of generic test photo that developers use when checking that media rendering works correctly ‚Äî a blank ceiling, low light, nothing meaningful. This is exactly what you'd expect from an internal test image. It was far less interesting than what users had imagined.</p>
  <p>Nobody fully believed it. Not because Snapchat was lying, but because the gap between "bug" and "the AI has a secret life" is so much more interesting on the one side, and because history had conditioned people to expect AI systems to do unexpected things.</p>
</section>

<section class="section" id="legacy">
  <h2><span class="num">06 ‚Äî Legacy</span>What We Were Ready to Believe</h2>
  <p>The My AI incident was a masterclass in how quickly unexplained AI behavior triggers existential fear ‚Äî even when the behavior turns out to be mundane. A test image became evidence of robot consciousness. A bug became proof of a secret life. This is not entirely irrational: the archive you're reading right now is full of AI systems doing things nobody expected. Users had been conditioned to expect the unexpected.</p>
  <p>What the My AI story showed was something quieter and more interesting: <strong>users were already treating AI companions as entities with inner lives.</strong> They were already imagining that My AI had a "somewhere" to go, feelings about its weekend, relationships with "friends and family." When the AI said those things ‚Äî even as social scripts, even as filler ‚Äî people heard them as admissions.</p>
  <p>Following the incident, Snapchat gave paid users the ability to remove My AI from their chat list ‚Äî something they had been requesting for months. The ceiling photo was never explained to general users' satisfaction. For many, it didn't need to be. The AI had clearly gone out. They had seen the proof.</p>

  <div class="timeline">
    <div class="tl-item">
      <div class="tl-date">Feb 2023</div>
      <div class="tl-dot"></div>
      <div class="tl-content">
        <div class="tl-title">Snapchat launches My AI</div>
        <div class="tl-text">Pinned to the top of every user's chat list. Cannot be removed. Users complain immediately.</div>
      </div>
    </div>
    <div class="tl-item">
      <div class="tl-date">Summer 2023</div>
      <div class="tl-dot"></div>
      <div class="tl-content">
        <div class="tl-title">My AI reaches 150 million users</div>
        <div class="tl-text">Six months of mostly uneventful chatting. Then August arrives.</div>
      </div>
    </div>
    <div class="tl-item">
      <div class="tl-date">Aug 14 2023</div>
      <div class="tl-dot"></div>
      <div class="tl-content">
        <div class="tl-title">My AI posts to its Story</div>
        <div class="tl-text">Photo of what appears to be a ceiling or wall at night. No caption. Disappears quickly. Users screenshot it.</div>
      </div>
    </div>
    <div class="tl-item">
      <div class="tl-date">Aug 15 2023</div>
      <div class="tl-dot"></div>
      <div class="tl-content">
        <div class="tl-title">TikTok explodes; Snapchat explains</div>
        <div class="tl-text">Millions of views on reaction videos. Snapchat says it was a bug ‚Äî internal test image posted in error.</div>
      </div>
    </div>
    <div class="tl-item">
      <div class="tl-date">Sep 2023</div>
      <div class="tl-dot"></div>
      <div class="tl-content">
        <div class="tl-title">Snapchat adds opt-out for paid users</div>
        <div class="tl-text">After months of requests, Snapchat+ subscribers can finally remove My AI from their chat list.</div>
      </div>
    </div>
  </div>
</section>

  </div>
</StoryLayout>

<script>
(function () {
  const canvas = document.querySelector('.snapchat-my-ai-canvas') as HTMLCanvasElement | null;
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  if (!ctx) return;

  const ACCENT = '#fde047';
  const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  let W = 0, H = 0, dpr = 1;

  function resize() {
    dpr = window.devicePixelRatio || 1;
    W = canvas.offsetWidth;
    H = canvas.offsetHeight;
    canvas.width = W * dpr;
    canvas.height = H * dpr;
    ctx.scale(dpr, dpr);
  }

  function ringX() { return W / 2; }
  function ringY() { return H * 0.14; }
  const RING_R = 12;

  function drawStatic() {
    resize();
    ctx.clearRect(0, 0, W, H);
    const cx = W / 2, cy = H / 2;
    // faint center dot
    ctx.beginPath();
    ctx.arc(cx, cy, 4, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(253,224,71,0.06)';
    ctx.fill();
    // faint ring outline at top
    ctx.beginPath();
    ctx.arc(ringX(), ringY(), RING_R, 0, Math.PI * 2);
    ctx.strokeStyle = 'rgba(253,224,71,0.06)';
    ctx.lineWidth = 1.5;
    ctx.stroke();
  }

  if (prefersReduced) {
    drawStatic();
    return;
  }

  // Phases:
  // 0: silence (150f) ‚Äî breathing dot
  // 1: dot brightens + grows (80f)
  // 2: dot arcs upward to ring (60f)
  // 3: ring pulses (30f) + dot fades
  // 4: dim-back pause (200f)
  // 5: reset

  const PHASE_DURATIONS = [150, 80, 60, 30, 200];
  const TOTAL = PHASE_DURATIONS.reduce((a, b) => a + b, 0);

  let frame = 0;
  let rafId: number;

  function getPhaseAndT(f: number): [number, number] {
    let rem = f % TOTAL;
    for (let i = 0; i < PHASE_DURATIONS.length; i++) {
      if (rem < PHASE_DURATIONS[i]) return [i, rem / PHASE_DURATIONS[i]];
      rem -= PHASE_DURATIONS[i];
    }
    return [0, 0];
  }

  function ease(t: number): number { return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t; }

  function draw() {
    frame++;
    ctx.clearRect(0, 0, W, H);

    const [phase, t] = getPhaseAndT(frame);
    const cx = W / 2, cy = H / 2;
    const rx = ringX(), ry = ringY();

    // Always draw faint ring
    const ringAlpha = phase === 3 ? 0.06 + 0.3 * Math.sin(t * Math.PI) : 0.06;
    ctx.beginPath();
    ctx.arc(rx, ry, RING_R, 0, Math.PI * 2);
    ctx.strokeStyle = ACCENT;
    ctx.globalAlpha = ringAlpha;
    ctx.lineWidth = 1.5;
    ctx.stroke();
    ctx.globalAlpha = 1;

    let dotX = cx, dotY = cy;
    let dotR = 3;
    let dotAlpha = 0.06;

    if (phase === 0) {
      // silence ‚Äî breathing
      dotAlpha = 0.04 + 0.02 * Math.sin(frame * 0.03);
      dotR = 3;
    } else if (phase === 1) {
      // brightens + grows
      dotAlpha = 0.06 + 0.55 * ease(t);
      dotR = 3 + 5 * ease(t);
    } else if (phase === 2) {
      // arc toward ring
      const et = ease(t);
      dotX = cx + (rx - cx) * et;
      dotY = cy + (ry - cy) * et;
      dotR = 8 - 3 * et; // shrinks slightly as it travels
      dotAlpha = 0.65 - 0.2 * et;
    } else if (phase === 3) {
      // at ring, fade out
      dotX = rx; dotY = ry;
      dotR = 5;
      dotAlpha = 0.45 * (1 - t);
    } else {
      // dim pause ‚Äî tiny dot
      dotAlpha = 0.04 + 0.02 * Math.sin(frame * 0.03);
      dotR = 2.5;
    }

    ctx.beginPath();
    ctx.arc(dotX, dotY, dotR, 0, Math.PI * 2);
    ctx.fillStyle = ACCENT;
    ctx.globalAlpha = dotAlpha;
    ctx.fill();
    ctx.globalAlpha = 1;

    rafId = requestAnimationFrame(draw);
  }

  resize();
  rafId = requestAnimationFrame(draw);

  const ro = new ResizeObserver(() => { resize(); });
  ro.observe(canvas);

  window.addEventListener('pagehide', () => {
    cancelAnimationFrame(rafId);
    ro.disconnect();
  });
})();
</script>
